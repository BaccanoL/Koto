# 🚀 Koto Desktop - 快速开始指南

> **一个完全独立的、专业的桌面应用程序**  
> 类似 VSCode、微信一样的应用体验 - 无需 Flask、无需端口映射

---

## ✨ 为什么选择 Koto Desktop？

| 特点 | 说明 |
|------|------|
| ✅ **完全独立** | 无需 Flask、无需浏览器、无需端口 |
| ✅ **专业 UI** | 现代化的桌面应用设计 |
| ✅ **一键启动** | 无需配置，开箱即用 |
| ✅ **智能自适应** | 集成强大的 Adaptive Agent 系统 |
| ✅ **系统集成** | 直接访问系统资源，无需网络隔离 |
| ✅ **本地优先** | 数据在本地处理，隐私更安全 |

---

## 🎯 三种启动方式

### 方式 1️⃣：批处理脚本（最简单）

```bash
双击: run_desktop.bat
```

**特点**: 
- 最简单，开箱即用
- 自动检查环境和依赖
- Windows 用户首选

---

### 方式 2️⃣：PowerShell 脚本（推荐）

```powershell
# 在 PowerShell 中运行
.\\run_desktop.ps1

# 或跳过依赖检查（如果已安装）
.\\run_desktop.ps1 -NoDepCheck

# 使用自定义 Python 路径
.\\run_desktop.ps1 -PythonPath "C:\\Python310\\python.exe"
```

**特点**:
- 彩色输出，易于查看
- 更多高级选项
- 错误信息更详细

---

### 方式 3️⃣：Python 启动器（开发者）

```bash
python launch_desktop.py
```

**特点**:
- 直接运行 Python
- 适合开发和调试
- 需要 Python 环境

---

## 📦 系统要求

| 要求 | 规格 |
|------|------|
| 操作系统 | Windows 7 SP1 或更高 |
| 内存 | 1 GB RAM (推荐 4 GB+) |
| 磁盘 | 500 MB 可用空间 |
| Python | 3.8+ (启动脚本会自动提示) |

---

## 🎨 应用界面预览

```
┌──────────────────────────────────────────────────┐
│ Koto - 智能桌面助手        [−][□][×]           │
├─────────────────┬──────────────────────────────┤
│                 │                              │
│ KOTO            │  📝 输入您的任务              │
│                 │  ─────────────────────────  │
│ 🤖 任务处理    │                              │
│ 📄 文档处理    │  请输入任务要求...           │
│ 💬 AI 助手     │                              │
│ ⚙️ 设置        │  ▶ 执行任务  🗑 清空         │
│ ℹ️ 关于        │                              │
│                 │  ─────────────────────────  │
│ v1.0.0          │  执行结果:                   │
│                 │  ✓ 已完成                    │
└─────────────────┴──────────────────────────────┘
```

---

## 🎯 核心功能

### 1️⃣ 任务处理 (🤖)

**最强大的功能！** 输入自然语言任务，AI 自动执行

```
示例任务：
• "创建一个 Word 文档，包含今日任务列表"
• "发送邮件给 team@example.com 关于项目进度"  
• "打开微信，发送消息给张三"
• "生成一个 PowerPoint 演示文稿，内容关于..."
• "创建日程提醒：明天上午10点开会"
```

**工作原理**:
1. 输入任务 (自然语言)
2. Agent 分析理解
3. 自动执行多步操作
4. 显示执行结果

---

### 2️⃣ 文档处理 (📄)

- 📝 创建 Word 文档
- 📊 生成 PowerPoint
- 📋 创建 Excel 表格
- 🔍 分析文档内容
- ✏️ 编辑现有文档
- 📤 导出为其他格式

---

### 3️⃣ AI 助手 (💬)

- 💭 实时聊天
- 🎯 自然语言理解
- 📚 学习你的习惯
- 💡 个性化建议

---

### 4️⃣ 设置 (⚙️)

- 🎨 主题选择
- 🔑 API 配置
- ⌨️ 快捷键管理
- ⚙️ 启动选项

---

### 5️⃣ 关于 (ℹ️)

- 📖 版本信息
- 🎓 功能说明
- 🚀 快速开始指南
- 🔗 相关资源

---

## ⌨️ 快捷键

| 快捷键 | 功能 |
|--------|------|
| `Ctrl+N` | 新建任务 |
| `Ctrl+,` | 打开设置 |
| `Ctrl+Q` | 退出应用 |
| `Ctrl+I` | 打开 AI 助手 |
| `Ctrl+D` | 打开文档处理 |
| `Ctrl+Enter` | 在任务面板提交 |

---

## 🔧 配置

### 配置文件位置

```
Koto/config/
├── user_settings.json       # 用户偏好设置
├── gemini_config.env        # API 密钥配置
└── app_config.json          # 应用配置
```

### 修改 API 密钥

编辑 `config/gemini_config.env`:

```env
GEMINI_API_KEY=your_api_key_here
MODEL=gemini-1.5-pro
```

---

## 📝 常见问题

### Q: 为什么是 PyQt/PySide6 而不是 Flask？

**A**: 
- ✅ 原生应用体验
- ✅ 直接访问系统资源
- ✅ 无需浏览器
- ✅ 更稳定，无端口冲突
- ✅ 更快的启动速度

### Q: 首次启动很慢？

**A**: 这是正常的，首次启动需要初始化。之后的启动会快得多。

### Q: 可以编译成独立的 EXE 吗？

**A**: 可以！运行：
```bash
python build_desktop_app.py
```

生成的应用将自动复制到桌面，完全独立，无需 Python。

### Q: Agent 不工作？

**A**:
1. 检查 `config/gemini_config.env` 中的 API 密钥
2. 检查网络连接
3. 查看日志：`logs/desktop_*.log`
4. 尝试重新启动应用

### Q: 如何查看日志？

**A**:
```bash
# 查看最新日志
logs/desktop_*.log

# 也可以在应用的"设置"中查看日志路径
```

---

## 🚀 编译成独立应用

如果想要一个完全独立的、无需 Python 的应用：

```bash
python build_desktop_app.py
```

**生成的文件包括**:
- 📦 `Koto_v1.0.0_Standalone.zip` - 可分发包
- 🖥️ `Koto.exe` - 可执行文件
- 📄 `BUILD_SUMMARY.json` - 构建信息

**分发方式**:
- 分享 ZIP 文件给任何 Windows PC
- 解压即用
- 无需安装 Python
- 无需管理员权限

---

## 📊 文件结构

```
Koto/
├── koto_desktop.py              # ⭐ 主应用 (PyQt6)
├── run_desktop.bat              # Windows 启动脚本
├── run_desktop.ps1              # PowerShell 启动脚本
├── launch_desktop.py            # Python 启动器
├── build_desktop_app.py         # PyInstaller 打包工具
│
├── web/                         # Web 组件和 API
│   ├── adaptive_agent.py        # AI 自适应代理
│   ├── document_generator.py    # 文档生成
│   └── ... (20+ 工具模块)
│
├── config/                      # 配置文件
│   ├── user_settings.json
│   ├── gemini_config.env
│   └── app_config.json
│
├── assets/                      # 应用资源
├── models/                      # AI 模型
├── logs/                        # 应用日志
│
└── DESKTOP_GUIDE.md             # 完整文档
```

---

## 🎯 使用场景

### 场景 1: 日常工作助手

```
用户: "帮我整理一下今天的会议记录，生成一个文档"
Agent: 
  1. 识别任务为文档生成
  2. 收集会议信息
  3. 生成 Word 文档
  4. 通知用户文档已保存
```

### 场景 2: 文档批量处理

```
用户: "我有 10 个 PDF，帮我转成 Word"
Agent:
  1. 遍历所有 PDF 文件
  2. 逐个转换为 Word
  3. 保存到指定目录
  4. 显示处理统计
```

### 场景 3: 工作流自动化

```
用户: "每天早上 8:30 提醒我检查邮件，然后生成日报"
Agent:
  1. 创建定时任务
  2. 每天 8:30 自动执行
  3. 检查新邮件
  4. 生成日报并发送
```

---

## 💡 最佳实践

### 编写任务时

✅ **好的做法**:
```
"创建一个 Word 文档，标题是'Q1 季度报告'，包含以下部分：
 1. 执行概要
 2. 关键成果
 3. 下一步计划"
```

❌ **避免**:
```
"做个文档"  # 太模糊
"用 python 创建 docx"  # 太技术性
```

---

## 🔐 隐私与安全

- 🔒 所有处理在本地进行
- 🔐 不上传个人数据
- 📝 配置文件本地存储
- 🛡️ 支持离线模式

---

## 📞 获取帮助

1. **查看日志**: `logs/desktop_*.log`
2. **查阅文档**: [DESKTOP_GUIDE.md](./DESKTOP_GUIDE.md)
3. **检查设置**: `config/` 目录
4. **重新启动**: 有时只需重启应用

---

## 🎉 现在就开始！

### 第一步：启动应用

```bash
run_desktop.bat
```

或双击 `run_desktop.bat` 文件

### 第二步：输入任务

在"任务处理"面板输入您的需求

### 第三步：查看结果

Agent 会自动执行并显示结果

---

## 🚀 下一步

- [ ] 启动应用并探索
- [ ] 尝试输入几个任务
- [ ] 配置 API 密钥
- [ ] 根据需要编译为 EXE
- [ ] 分发给同事或朋友

---

**版本**: 1.0.0  
**最后更新**: 2026-02-12  
**更新日志**: [查看完整日志](./CHANGELOG.md)

---

**感谢使用 Koto Desktop！** 🎉

有问题？查看 [DESKTOP_GUIDE.md](./DESKTOP_GUIDE.md) 获取更多信息。
