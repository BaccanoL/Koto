# 触发器参数可编辑功能 - 用户快速指南

## 🎯 功能概述

现在可以**直接在 Koto 界面上编辑托发器的阈值参数**，无需修改代码或重启应用。所有修改会立即生效并永久保存。

## 🚀 快速开始

### 第一步：打开触发器面板
1. 在 Koto 主界面顶部工具栏中找到 **"🧭 触发器"** 按钮
2. 点击打开触发器管理面板

### 第二步：浏览触发器列表
面板会显示所有已启用的触发器，包括：
- 触发器名称（ID）
- 触发类型（定期/事件/阈值等）
- 完整描述
- 当前配置信息

### 第三步：编辑触发器配置

#### 基础配置（直接在触发器项中）：
- **☑️ 启用/禁用**: 用复选框快速启用或禁用触发器
- **优先级**: 1-10 的数字，数值越高触发时优先级越高
- **冷却时间**: 两次触发之间的最少等待时间（分钟）

#### 高级参数（创建扩展参数区）：
1. 点击触发器项中的 **"⚙️ 参数"** 按钮
2. 参数编辑区会展开，显示所有可配置的参数
3. 每个参数为 **标签 + 输入框** 的格式
4. 直接在输入框中修改数值

### 第四步：保存更改
1. 完成所有修改后，点击 **"保存"** 按钮
2. 应用会立即保存配置到数据库
3. 屏幕显示 "✅ 触发器已更新" 提示

## 📋 常用触发器参数说明

### 🕐 工作时长触发器 (`threshold_work_too_long`)
**用途**: 提醒用户休息

| 参数 | 默认值 | 说明 |
|------|--------|------|
| `work_duration_hours` | 2 | 工作多少小时后提醒 |
| `urgency_per_hour` | 0.1 | 每小时增加多少紧急度 |
| `max_urgency` | 1.0 | 紧急度的上限 |

**调整建议**:
- 如果觉得 2 小时提醒太频繁 → 改为 3 或 4
- 如果想要更急促的提醒 → 增加 `urgency_per_hour` 到 0.2

### 💾 编辑次数触发器 (`threshold_edit_count`)
**用途**: 提醒备份频繁编辑的文件

| 参数 | 默认值 | 说明 |
|------|--------|------|
| `edit_count_threshold` | 10 | 编辑多少次后提醒备份 |
| `check_recent_events` | 100 | 从最近多少条事件中统计 |

**调整建议**:
- 编辑次数改为 20/30 可降低提醒频率
- 减少到 5 会更频繁地提醒备份

### 🔍 搜索模式触发器 (`pattern_repeated_search`)
**用途**: 检测重复搜索并提供优化建议

| 参数 | 默认值 | 说明 |
|------|--------|------|
| `search_threshold` | 3 | 多少次搜索后触发 |
| `check_recent_searches` | 50 | 检查最近多少条搜索 |

**调整建议**:
- 降到 2 会更容易被触发
- 提高到 5 会更谨慎地提醒

### 🌅 早晨问候触发器 (`periodic_morning_greeting`)
**用途**: 在特定时间早晨问候

| 参数 | 默认值 | 说明 |
|------|--------|------|
| `morning_start_hour` | 6 | 早晨开始时刻（24小时制） |
| `morning_end_hour` | 10 | 早晨结束时刻 |

**调整建议**:
- 改为 7-9 : 只在 7-9 点显示早晨问候
- 改为 8-8 : 只在 8 点这个时刻显示

### 📂 杂乱文件触发器 (`threshold_unorganized_files`)
**用途**: 提示整理杂乱的文件夹

| 参数 | 默认值 | 说明 |
|------|--------|------|
| `organization_suggestion_threshold` | 2 | 多少个建议后触发 |

### 🔄 信息返回触发器 (`event_return_after_break`)
**用途**: 长时间不活动后欢迎回来

| 参数 | 默认值 | 说明 |
|------|--------|------|
| `break_timeout_hours` | 4 | 多少小时无活动后触发 |

## 💡 使用场景示例

### 场景 1: 我工作很专注，不想频繁被打扰

**操作步骤**:
1. 找到 "threshold_work_too_long" 触发器
2. 修改 `work_duration_hours` 为 5 或 6
3. 保存

**结果**: 现在需要工作 5-6 小时才会收到休息提醒

---

### 场景 2: 我早起，想改变早晨问候时间

**操作步骤**:
1. 找到 "periodic_morning_greeting" 触发器
2. 点击 "⚙️ 参数"
3. 修改:
   - `morning_start_hour`: 改为 5
   - `morning_end_hour`: 改为 7
4. 保存

**结果**: 现在只在 5-7 点显示早晨问候

---

### 场景 3: 我一直在搜索，不想频繁被提示

**操作步骤**:
1. 找到 "pattern_repeated_search" 触发器
2. 点击 "⚙️ 参数"
3. 修改 `search_threshold` 为 5 或更高
4. 保存

**结果**: 搜索次数更多时才会触发优化建议

---

## ✨ 功能特点

✅ **即时生效** - 无需重启应用，修改立即有效  
✅ **永久保存** - 数据存储到数据库，下次启动自动加载  
✅ **简单易用** - 无需编程知识，完全 UI 操作  
✅ **灵活定制** - 根据个人习惯自由调整  
✅ **类型识别** - 自动识别参数类型（数字、文本等）  

## 🆘 常见问题

### Q: 修改后没有立即生效？
**A**: 请确保点击了"保存"按钮。修改保存后会显示"✅ 触发器已更新"提示。

### Q: 参数值有范围限制吗？
**A**: 不同参数有不同的范围：
- 优先级: 1-10
- 时间参数: 通常为小时或分钟
- 比率参数: 通常为 0-1 的小数

### Q: 如何重置参数为默认值？
**A**: 目前需要重启应用，Koto 会加载内置的默认参数。

### Q: 可以同时修改多个参数吗？
**A**: 可以。在参数区域修改多个值，然后一次性点击"保存"即可。

### Q: 如果不小心改错了怎么办？
**A**: 重新打开面板，修改为想要的值重新保存即可。目前不支持参数回滚。

## 📊 参数修改记录

所有参数修改都会被记录，修改时间会显示在数据库的 `last_modified` 字段。

## 🔮 未来会增加的功能

- 参数值验证和范围提示
- 预设配置（"保守"、"平衡"、"激进"）
- 参数修改历史和回滚功能
- 参数导出/导入（备份/恢复）
- 参数详细说明（鼠标悬停提示）

## 📞 反馈和建议

如果在使用过程中遇到问题或有功能建议，请：
1. 检查应用日志
2. 查看"TRIGGER_PARAMETERS_GUIDE.md"获取更多技术细节
3. 提交问题报告

---

**最后更新**: 2025年2月14日  
**功能状态**: ✅ 生产就绪  
**版本**: 1.0
