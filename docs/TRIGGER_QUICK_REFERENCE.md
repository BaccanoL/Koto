# 触发器参数编辑 - 快速参考卡

## 🎯 5 分钟快速上手

### 第一步：打开面板
```
点击顶部: 🧭 触发器  →  打开触发器管理面板
```

### 第二步：找到并编辑
```
1. 找到要编辑的触发器 (如: threshold_work_too_long)
2. 点击 "⚙️ 参数" 按钮展开参数区
3. 修改参数值
4. 点击 "保存"
```

### 第三步：完成！
```
✅ 参数已保存，立即生效
```

---

## 📝 常用参数速查表

### 工作太累？改工作时长阈值
```
触发器: threshold_work_too_long
参数:   work_duration_hours
默认:   2 小时
改为:   3-4 (延迟提醒)
```

### 早起？改早晨问候时间
```
触发器: periodic_morning_greeting
参数:   morning_start_hour, morning_end_hour
默认:   6-10 点
改为:   7-9 点
```

### 频繁搜索？改搜索灵敏度
```
触发器: pattern_repeated_search
参数:   search_threshold
默认:   3 次搜索
改为:   5 (降低灵敏度)
```

### 文件编辑多？改备份提醒
```
触发器: threshold_edit_count
参数:   edit_count_threshold
默认:   10 次
改为:   20 (降低提醒频率)
```

---

## 🔗 API 速查

### 获取参数列表
```bash
curl -X GET http://localhost:5000/api/triggers/list
```

### 更新参数
```bash
curl -X POST http://localhost:5000/api/triggers/update \
  -H "Content-Type: application/json" \
  -d '{
    "trigger_id": "threshold_work_too_long",
    "parameters": {
      "work_duration_hours": 3,
      "urgency_per_hour": 0.15
    }
  }'
```

### 获取单个触发器参数
```bash
curl -X GET http://localhost:5000/api/triggers/params/threshold_work_too_long
```

---

## 💡 常见修改方案

### 方案 A: 我很专注，不想被打扰
```
工作时长阈值:  2 → 5 小时
搜索灵敏度:    3 → 5 次搜索
编辑提醒:      10 → 20 次
→ 所有提醒都延迟触发
```

### 方案 B: 我喜欢频繁提醒和关怀
```
工作时长阈值:  2 → 1.5 小时
搜索灵敏度:    3 → 2 次搜索
编辑提醒:      10 → 5 次
→ 更细致的提醒
```

### 方案 C: 我的工作时间很烂，需要特别提醒
```
早晨问候:      6-10 → 5-11  (更长的时间)
工作时长:      2 → 2.5 小时 (更早提醒)
→ 无处不在的关怀
```

---

## ❓ 常见问题

**Q: 修改后多久生效？**
A: 立即生效（保存后）

**Q: 会影响已有的工作吗？**
A: 不会，修改只影响触发时机

**Q: 参数会保存吗？**
A: 会的，永久保存到数据库

**Q: 可以恢复默认值吗？**
A: 重启应用，会加载内置默认值

**Q: 能同时改多个吗？**
A: 可以，修改多个后一次保存即可

---

## 🎮 UI 交互快速指南

```
触发器项布局:
┌────────────────────────────────────┐
│ 触发器名称              [类型]     │
│ 一条简短的描述                      │
│ ☑ 启用 | 优先级:[8] | 冷却:[60] │ [⚙️参数] [保存]
│                                    │
│ 参数编辑区(初始隐藏)               │
│ ┌──────────────────────────────┐  │
│ │ 参数1名称  [__________]      │  │
│ │ 参数2名称  [__________]      │  │
│ │ 参数3名称  [__________]      │  │
│ └──────────────────────────────┘  │
└────────────────────────────────────┘
```

---

## 🚀 快捷键/对应关系

| 动作 | 快捷方式 |
|------|---------|
| 打开面板 | 点 "🧭 触发器" 按钮 |
| 展开参数 | 点 "⚙️ 参数" 按钮 |
| 保存修改 | 点 "保存" 按钮或 Ctrl+S* |
| 刷新列表 | F5 或重新打开面板 |
| 关闭面板 | Esc 或点 × 按钮 |

*Ctrl+S 目前不支持，使用按钮即可

---

## 📊 参数修改示例流程

### 改工作时长从 2 小时到 3 小时

```
1️⃣ 点击 "🧭 触发器"
   └─ 面板打开

2️⃣ 找到 "threshold_work_too_long"
   └─ 看到 "连续工作时间超过阈值"

3️⃣ 点击 "⚙️ 参数"
   └─ 展开参数编辑区：
      work_duration_hours: [2]
      urgency_per_hour: [0.1]
      max_urgency: [1.0]

4️⃣ 修改第一个参数
   └─ work_duration_hours: [2] → [3]

5️⃣ 点击 "保存"
   └─ ✅ 显示 "触发器已更新"
   └─ 面板刷新显示新值

6️⃣ 完成！
   └─ 现在需要 3 小时才会触发休息提醒
```

---

## 🔍 参数详解速查

| 参数名称 | 解释 | 范围 | 示例 |
|---------|------|------|------|
| `work_duration_hours` | 工作多少小时提醒 | 1-12 | 2, 3, 4 |
| `urgency_per_hour` | 每小时紧急度增长 | 0.05-0.5 | 0.1, 0.2 |
| `max_urgency` | 紧急度上限 | 0.5-1.0 | 0.8, 1.0 |
| `morning_start_hour` | 早晨开始时刻 | 0-23 | 6, 7, 8 |
| `morning_end_hour` | 早晨结束时刻 | 0-23 | 9, 10, 11 |
| `search_threshold` | 搜索次数阈值 | 2-10 | 3, 4, 5 |
| `edit_count_threshold` | 编辑次数阈值 | 5-30 | 10, 15, 20 |

---

## 📱 移动设备友好

在平板或手机上：
1. 点击 "🧭 触发器"
2. 向上/向下滑动列表
3. 点击 "⚙️ 参数"
4. 编辑参数
5. 点击 "保存"

参数编辑区会自适应屏幕大小

---

## 🎓 进阶使用

### 从 API 直接修改（开发者）

```python
import requests

# 获取参数
response = requests.get(
    'http://localhost:5000/api/triggers/params/threshold_work_too_long'
)
print(response.json())

# 更新参数
requests.post(
    'http://localhost:5000/api/triggers/update',
    json={
        'trigger_id': 'threshold_work_too_long',
        'parameters': {
            'work_duration_hours': 4,
            'urgency_per_hour': 0.12
        }
    }
)
```

---

## ✨ 提示和技巧

💡 **Tip 1**: 一次保存可以修改多个参数

💡 **Tip 2**: 优先级高的触发器优先触发（1-10）

💡 **Tip 3**: 冷却时间防止同一触发器频繁触发

💡 **Tip 4**: 参数支持小数（0.1, 0.15, 0.25）

💡 **Tip 5**: 修改是即时的，无需重启应用

💡 **Tip 6**: 可以在任何时候修改，任何时候生效

---

## 🆘 快速排查

| 问题 | 解决方案 |
|-----|---------|
| 参数没保存 | 检查是否点了保存按钮 |
| 修改没生效 | 刷新页面，重新打开面板 |
| 面板打不开 | 检查浏览器控制台，查看错误日志 |
| 参数显示错误 | 清除浏览器缓存，重新打开 |
| API 返回错误 | 检查触发器 ID 是否正确 |

---

## 📞 需要帮助？

- **快速问题** → 本卡片和 FAQ
- **详细问题** → `TRIGGER_USER_GUIDE.md`
- **技术问题** → `TRIGGER_PARAMETERS_GUIDE.md`
- **测试问题** → 运行 `test_trigger_params_integration.py`

---

**版本**: 1.0  
**更新**: 2025-02-14  
**状态**: ✅ 生产就绪

🎉 **现在开始编辑你的触发器吧！**
